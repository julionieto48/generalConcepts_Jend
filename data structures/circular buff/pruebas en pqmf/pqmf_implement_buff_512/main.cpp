//
//  main.cpp
//  pqmf_implements
//
//  Created by MAC on 3/8/19.
//  Copyright © 2019 MAC. All rights reserved.
//

#include <iostream>
#include "PQMF_Process_Buffer.hpp"
#include "PQMF_Filter.hpp"
#include "IPQMF_Filter.hpp"


int main() {
    
    for(int i = 0; i < 512; i++){std::cout << "c[" << i << "] = " << c[i] << std::endl;}
    
    //float a[512];
    //for(int i = 1; i < 513; i++){a[i-1] = -1 + 2.0*i/513.0;}
    //for(int i = 1; i < 513; i++){a[i-1] = i;}
    float a[1024] = {0,-1.407948e-01,-2.787847e-01,-4.112205e-01,-5.354637e-01,-6.490393e-01,-7.496844e-01,-8.353940e-01,-9.044606e-01,-9.555081e-01,-9.875196e-01,-9.998574e-01,-9.922755e-01,-9.649252e-01,-9.183512e-01,-8.534815e-01,-7.716083e-01,-6.743629e-01,-5.636825e-01,-4.417722e-01,-3.110607e-01,-1.741522e-01,-3.377414e-02,1.072768e-01,2.461905e-01,3.801995e-01,5.066340e-01,6.229752e-01,7.269052e-01,8.163534e-01,8.895380e-01,9.450008e-01,9.816369e-01,9.987165e-01,9.958992e-01,9.732412e-01,9.311939e-01,8.705950e-01,7.926518e-01,6.989170e-01,5.912581e-01,4.718199e-01,3.429819e-01,2.073109e-01,6.750975e-02,-7.363634e-02,-2.133154e-01,-3.487447e-01,-4.772262e-01,-5.962002e-01,-7.032965e-01,-7.963814e-01,-8.736004e-01,-9.334152e-01,-9.746342e-01,-9.964361e-01,-9.983866e-01,-9.804468e-01,-9.429742e-01,-8.867152e-01,-8.127908e-01,-7.226736e-01,-6.181590e-01,-5.013292e-01,-3.745117e-01,-2.402330e-01,-1.011683e-01,3.991188e-02,1.801969e-01,3.168921e-01,4.472739e-01,5.687450e-01,6.788853e-01,7.755006e-01,8.566660e-01,9.207646e-01,9.665194e-01,9.930187e-01,9.997348e-01,9.865337e-01,9.536785e-01,9.018237e-01,8.320024e-01,7.456056e-01,6.443546e-01,5.302665e-01,4.056142e-01,2.728810e-01,1.347115e-01,-6.141883e-03,-1.468729e-01,-2.846778e-01,-4.168112e-01,-5.406408e-01,-6.536995e-01,-7.537350e-01,-8.387542e-01,-9.070634e-01,-9.573017e-01,-9.884683e-01,-9.999422e-01,-9.914949e-01,-9.632946e-01,-9.159031e-01,-8.502647e-01,-7.676869e-01,-6.698150e-01,-5.585987e-01,-4.362538e-01,-3.052177e-01,-1.681009e-01,-2.763513e-02,1.133812e-01,2.521387e-01,3.858730e-01,5.119198e-01,6.277679e-01,7.311093e-01,8.198853e-01,8.923272e-01,9.469918e-01,9.827901e-01,9.990088e-01,9.953248e-01,9.718116e-01,9.289375e-01,8.675568e-01,7.888923e-01,6.945111e-01,5.862936e-01,4.663957e-01,3.372061e-01,2.012985e-01,6.138060e-02,-7.976016e-02,-2.193119e-01,-3.544944e-01,-4.826146e-01,-6.011199e-01,-7.076494e-01,-8.000809e-01,-8.765728e-01,-9.356013e-01,-9.759904e-01,-9.969354e-01,-9.980190e-01,-9.792197e-01,-9.409120e-01,-8.838590e-01,-8.091975e-01,-7.184147e-01,-6.133195e-01,-4.960054e-01,-3.688097e-01,-2.342665e-01,-9.505604e-02,4.604812e-02,1.862349e-01,3.227114e-01,4.527588e-01,5.737860e-01,6.833821e-01,7.793636e-01,8.598183e-01,9.231433e-01,9.680771e-01,9.937245e-01,9.995745e-01,9.855105e-01,9.518128e-01,8.991527e-01,8.285794e-01,7.414987e-01,6.396456e-01,5.250492e-01,3.999925e-01,2.669671e-01,1.286230e-01,-1.228353e-02,-1.529454e-01,-2.905602e-01,-4.223863e-01,-5.457975e-01,-6.583351e-01,-7.577571e-01,-8.420827e-01,-9.096320e-01,-9.590592e-01,-9.893797e-01,-9.999894e-01,-9.906769e-01,-9.616276e-01,-9.134205e-01,-8.470158e-01,-7.637366e-01,-6.652418e-01,-5.534939e-01,-4.307190e-01,-2.993631e-01,-1.620432e-01,-2.149507e-02,1.194813e-01,2.580774e-01,3.915319e-01,5.171862e-01,6.325369e-01,7.352859e-01,8.233862e-01,8.950828e-01,9.489471e-01,9.839061e-01,9.992633e-01,9.947128e-01,9.703452e-01,9.266460e-01,8.644858e-01,7.851030e-01,6.900790e-01,5.813070e-01,4.609539e-01,3.314176e-01,1.952786e-01,5.524914e-02,-8.588097e-02,-2.253001e-01,-3.602308e-01,-4.879848e-01,-6.060169e-01,-7.119757e-01,-8.037503e-01,-8.795122e-01,-9.377521e-01,-9.773098e-01,-9.973971e-01,-9.976138e-01,-9.779556e-01,-9.388143e-01,-8.809695e-01,-8.055736e-01,-7.141288e-01,-6.084568e-01,-4.906629e-01,-3.630939e-01,-2.282911e-01,-8.894018e-02,5.218262e-02,1.922658e-01,3.285186e-01,4.582265e-01,5.788055e-01,6.878532e-01,7.831973e-01,8.629381e-01,9.254872e-01,9.695983e-01,9.943927e-01,9.993765e-01,9.844502e-01,9.499113e-01,8.964479e-01,8.251251e-01,7.373638e-01,6.349124e-01,5.198121e-01,3.943559e-01,2.610431e-01,1.225297e-01,-1.842472e-02,-1.590121e-01,-2.964316e-01,-4.279454e-01,-5.509336e-01,-6.629458e-01,-7.617506e-01,-8.453794e-01,-9.121663e-01,-9.607806e-01,-9.902538e-01,-9.999988e-01,-9.898214e-01,-9.599244e-01,-9.109034e-01,-8.437350e-01,-7.597574e-01,-6.606436e-01,-5.483681e-01,-4.251679e-01,-2.934973e-01,-1.559795e-01,-1.535420e-02,1.255770e-01,2.640063e-01,3.971761e-01,5.224331e-01,6.372820e-01,7.394347e-01,8.268561e-01,8.978045e-01,9.508665e-01,9.849850e-01,9.994802e-01,9.940633e-01,9.688423e-01,9.243196e-01,8.613823e-01,7.812841e-01,6.856209e-01,5.762985e-01,4.554948e-01,3.256165e-01,1.892512e-01,4.911560e-02,-9.199854e-02,-2.312799e-01,-3.659535e-01,-4.933365e-01,-6.108910e-01,-7.162752e-01,-8.073893e-01,-8.824184e-01,-9.398676e-01,-9.785923e-01,-9.978211e-01,-9.971709e-01,-9.766547e-01,-9.366812e-01,-8.780467e-01,-8.019194e-01,-7.098159e-01,-6.035712e-01,-4.853020e-01,-3.573643e-01,-2.223071e-01,-8.282096e-02,5.831515e-02,1.982895e-01,3.343134e-01,4.636770e-01,5.838030e-01,6.922983e-01,7.870013e-01,8.660254e-01,9.277962e-01,9.710830e-01,9.950235e-01,9.991407e-01,9.833527e-01,9.479739e-01,8.937092e-01,8.216396e-01,7.332011e-01,6.301553e-01,5.145554e-01,3.887043e-01,2.551092e-01,1.164318e-01,-2.456521e-02,-1.650728e-01,-3.022918e-01,-4.334884e-01,-5.560489e-01,-6.675315e-01,-7.657153e-01,-8.486443e-01,-9.146661e-01,-9.624657e-01,-9.910905e-01,-9.999705e-01,-9.889287e-01,-9.581850e-01,-9.083520e-01,-8.404224e-01,-7.557496e-01,-6.560204e-01,-5.432217e-01,-4.196008e-01,-2.876203e-01,-1.499098e-01,-9.212751e-03,1.316679e-01,2.699253e-01,4.028052e-01,5.276603e-01,6.420031e-01,7.435557e-01,8.302948e-01,9.004925e-01,9.527501e-01,9.860267e-01,9.996593e-01,9.933763e-01,9.673028e-01,9.219583e-01,8.582462e-01,7.774358e-01,6.811369e-01,5.712682e-01,4.500185e-01,3.198032e-01,1.832168e-01,4.298020e-02,-9.811265e-02,-2.372509e-01,-3.716625e-01,-4.986696e-01,-6.157421e-01,-7.205476e-01,-8.109979e-01,-8.852913e-01,-9.419475e-01,-9.798379e-01,-9.982075e-01,-9.966904e-01,-9.753169e-01,-9.345127e-01,-8.750908e-01,-7.982349e-01,-7.054763e-01,-5.986629e-01,-4.799227e-01,-3.516213e-01,-2.163147e-01,-7.669862e-02,6.444548e-02,2.043057e-01,3.400956e-01,4.691100e-01,5.887786e-01,6.967173e-01,7.907757e-01,8.690800e-01,9.300701e-01,9.725310e-01,9.956167e-01,9.988673e-01,9.822181e-01,9.460008e-01,8.909368e-01,8.181232e-01,7.290107e-01,6.253745e-01,5.092793e-01,3.830381e-01,2.491658e-01,1.103295e-01,-3.070478e-02,-1.711274e-01,-3.081407e-01,-4.390151e-01,-5.611432e-01,-6.720921e-01,-7.696512e-01,-8.518771e-01,-9.171315e-01,-9.641144e-01,-9.918899e-01,-9.999045e-01,-9.879986e-01,-9.564094e-01,-9.057663e-01,-8.370781e-01,-7.517132e-01,-6.513725e-01,-5.380548e-01,-4.140178e-01,-2.817326e-01,-1.438345e-01,-3.070956e-03,1.377538e-01,2.758341e-01,4.084192e-01,5.328676e-01,6.467000e-01,7.476486e-01,8.337022e-01,9.031464e-01,9.545978e-01,9.870313e-01,9.998008e-01,9.926518e-01,9.657268e-01,9.195623e-01,8.550778e-01,7.735581e-01,6.766273e-01,5.662164e-01,4.445251e-01,3.139779e-01,1.771754e-01,3.684319e-02,-1.042230e-01,-2.432129e-01,-3.773574e-01,-5.039840e-01,-6.205700e-01,-7.247928e-01,-8.145760e-01,-8.881308e-01,-9.439920e-01,-9.810465e-01,-9.985563e-01,-9.961724e-01,-9.739423e-01,-9.323090e-01,-8.721018e-01,-7.945203e-01,-7.011100e-01,-5.937319e-01,-4.745253e-01,-3.458649e-01,-2.103141e-01,-7.057338e-02,7.057338e-02,2.103141e-01,3.458649e-01,4.745253e-01,5.937319e-01,7.011100e-01,7.945203e-01,8.721018e-01,9.323090e-01,9.739423e-01,9.961724e-01,9.985563e-01,9.810465e-01,9.439920e-01,8.881308e-01,8.145760e-01,7.247928e-01,6.205700e-01,5.039840e-01,3.773574e-01,2.432129e-01,1.042230e-01,-3.684319e-02,-1.771754e-01,-3.139779e-01,-4.445251e-01,-5.662164e-01,-6.766273e-01,-7.735581e-01,-8.550778e-01,-9.195623e-01,-9.657268e-01,-9.926518e-01,-9.998008e-01,-9.870313e-01,-9.545978e-01,-9.031464e-01,-8.337022e-01,-7.476486e-01,-6.467000e-01,-5.328676e-01,-4.084192e-01,-2.758341e-01,-1.377538e-01,3.070956e-03,1.438345e-01,2.817326e-01,4.140178e-01,5.380548e-01,6.513725e-01,7.517132e-01,8.370781e-01,9.057663e-01,9.564094e-01,9.879986e-01,9.999045e-01,9.918899e-01,9.641144e-01,9.171315e-01,8.518771e-01,7.696512e-01,6.720921e-01,5.611432e-01,4.390151e-01,3.081407e-01,1.711274e-01,3.070478e-02,-1.103295e-01,-2.491658e-01,-3.830381e-01,-5.092793e-01,-6.253745e-01,-7.290107e-01,-8.181232e-01,-8.909368e-01,-9.460008e-01,-9.822181e-01,-9.988673e-01,-9.956167e-01,-9.725310e-01,-9.300701e-01,-8.690800e-01,-7.907757e-01,-6.967173e-01,-5.887786e-01,-4.691100e-01,-3.400956e-01,-2.043057e-01,-6.444548e-02,7.669862e-02,2.163147e-01,3.516213e-01,4.799227e-01,5.986629e-01,7.054763e-01,7.982349e-01,8.750908e-01,9.345127e-01,9.753169e-01,9.966904e-01,9.982075e-01,9.798379e-01,9.419475e-01,8.852913e-01,8.109979e-01,7.205476e-01,6.157421e-01,4.986696e-01,3.716625e-01,2.372509e-01,9.811265e-02,-4.298020e-02,-1.832168e-01,-3.198032e-01,-4.500185e-01,-5.712682e-01,-6.811369e-01,-7.774358e-01,-8.582462e-01,-9.219583e-01,-9.673028e-01,-9.933763e-01,-9.996593e-01,-9.860267e-01,-9.527501e-01,-9.004925e-01,-8.302948e-01,-7.435557e-01,-6.420031e-01,-5.276603e-01,-4.028052e-01,-2.699253e-01,-1.316679e-01,9.212751e-03,1.499098e-01,2.876203e-01,4.196008e-01,5.432217e-01,6.560204e-01,7.557496e-01,8.404224e-01,9.083520e-01,9.581850e-01,9.889287e-01,9.999705e-01,9.910905e-01,9.624657e-01,9.146661e-01,8.486443e-01,7.657153e-01,6.675315e-01,5.560489e-01,4.334884e-01,3.022918e-01,1.650728e-01,2.456521e-02,-1.164318e-01,-2.551092e-01,-3.887043e-01,-5.145554e-01,-6.301553e-01,-7.332011e-01,-8.216396e-01,-8.937092e-01,-9.479739e-01,-9.833527e-01,-9.991407e-01,-9.950235e-01,-9.710830e-01,-9.277962e-01,-8.660254e-01,-7.870013e-01,-6.922983e-01,-5.838030e-01,-4.636770e-01,-3.343134e-01,-1.982895e-01,-5.831515e-02,8.282096e-02,2.223071e-01,3.573643e-01,4.853020e-01,6.035712e-01,7.098159e-01,8.019194e-01,8.780467e-01,9.366812e-01,9.766547e-01,9.971709e-01,9.978211e-01,9.785923e-01,9.398676e-01,8.824184e-01,8.073893e-01,7.162752e-01,6.108910e-01,4.933365e-01,3.659535e-01,2.312799e-01,9.199854e-02,-4.911560e-02,-1.892512e-01,-3.256165e-01,-4.554948e-01,-5.762985e-01,-6.856209e-01,-7.812841e-01,-8.613823e-01,-9.243196e-01,-9.688423e-01,-9.940633e-01,-9.994802e-01,-9.849850e-01,-9.508665e-01,-8.978045e-01,-8.268561e-01,-7.394347e-01,-6.372820e-01,-5.224331e-01,-3.971761e-01,-2.640063e-01,-1.255770e-01,1.535420e-02,1.559795e-01,2.934973e-01,4.251679e-01,5.483681e-01,6.606436e-01,7.597574e-01,8.437350e-01,9.109034e-01,9.599244e-01,9.898214e-01,9.999988e-01,9.902538e-01,9.607806e-01,9.121663e-01,8.453794e-01,7.617506e-01,6.629458e-01,5.509336e-01,4.279454e-01,2.964316e-01,1.590121e-01,1.842472e-02,-1.225297e-01,-2.610431e-01,-3.943559e-01,-5.198121e-01,-6.349124e-01,-7.373638e-01,-8.251251e-01,-8.964479e-01,-9.499113e-01,-9.844502e-01,-9.993765e-01,-9.943927e-01,-9.695983e-01,-9.254872e-01,-8.629381e-01,-7.831973e-01,-6.878532e-01,-5.788055e-01,-4.582265e-01,-3.285186e-01,-1.922658e-01,-5.218262e-02,8.894018e-02,2.282911e-01,3.630939e-01,4.906629e-01,6.084568e-01,7.141288e-01,8.055736e-01,8.809695e-01,9.388143e-01,9.779556e-01,9.976138e-01,9.973971e-01,9.773098e-01,9.377521e-01,8.795122e-01,8.037503e-01,7.119757e-01,6.060169e-01,4.879848e-01,3.602308e-01,2.253001e-01,8.588097e-02,-5.524914e-02,-1.952786e-01,-3.314176e-01,-4.609539e-01,-5.813070e-01,-6.900790e-01,-7.851030e-01,-8.644858e-01,-9.266460e-01,-9.703452e-01,-9.947128e-01,-9.992633e-01,-9.839061e-01,-9.489471e-01,-8.950828e-01,-8.233862e-01,-7.352859e-01,-6.325369e-01,-5.171862e-01,-3.915319e-01,-2.580774e-01,-1.194813e-01,2.149507e-02,1.620432e-01,2.993631e-01,4.307190e-01,5.534939e-01,6.652418e-01,7.637366e-01,8.470158e-01,9.134205e-01,9.616276e-01,9.906769e-01,9.999894e-01,9.893797e-01,9.590592e-01,9.096320e-01,8.420827e-01,7.577571e-01,6.583351e-01,5.457975e-01,4.223863e-01,2.905602e-01,1.529454e-01,1.228353e-02,-1.286230e-01,-2.669671e-01,-3.999925e-01,-5.250492e-01,-6.396456e-01,-7.414987e-01,-8.285794e-01,-8.991527e-01,-9.518128e-01,-9.855105e-01,-9.995745e-01,-9.937245e-01,-9.680771e-01,-9.231433e-01,-8.598183e-01,-7.793636e-01,-6.833821e-01,-5.737860e-01,-4.527588e-01,-3.227114e-01,-1.862349e-01,-4.604812e-02,9.505604e-02,2.342665e-01,3.688097e-01,4.960054e-01,6.133195e-01,7.184147e-01,8.091975e-01,8.838590e-01,9.409120e-01,9.792197e-01,9.980190e-01,9.969354e-01,9.759904e-01,9.356013e-01,8.765728e-01,8.000809e-01,7.076494e-01,6.011199e-01,4.826146e-01,3.544944e-01,2.193119e-01,7.976016e-02,-6.138060e-02,-2.012985e-01,-3.372061e-01,-4.663957e-01,-5.862936e-01,-6.945111e-01,-7.888923e-01,-8.675568e-01,-9.289375e-01,-9.718116e-01,-9.953248e-01,-9.990088e-01,-9.827901e-01,-9.469918e-01,-8.923272e-01,-8.198853e-01,-7.311093e-01,-6.277679e-01,-5.119198e-01,-3.858730e-01,-2.521387e-01,-1.133812e-01,2.763513e-02,1.681009e-01,3.052177e-01,4.362538e-01,5.585987e-01,6.698150e-01,7.676869e-01,8.502647e-01,9.159031e-01,9.632946e-01,9.914949e-01,9.999422e-01,9.884683e-01,9.573017e-01,9.070634e-01,8.387542e-01,7.537350e-01,6.536995e-01,5.406408e-01,4.168112e-01,2.846778e-01,1.468729e-01,6.141883e-03,-1.347115e-01,-2.728810e-01,-4.056142e-01,-5.302665e-01,-6.443546e-01,-7.456056e-01,-8.320024e-01,-9.018237e-01,-9.536785e-01,-9.865337e-01,-9.997348e-01,-9.930187e-01,-9.665194e-01,-9.207646e-01,-8.566660e-01,-7.755006e-01,-6.788853e-01,-5.687450e-01,-4.472739e-01,-3.168921e-01,-1.801969e-01,-3.991188e-02,1.011683e-01,2.402330e-01,3.745117e-01,5.013292e-01,6.181590e-01,7.226736e-01,8.127908e-01,8.867152e-01,9.429742e-01,9.804468e-01,9.983866e-01,9.964361e-01,9.746342e-01,9.334152e-01,8.736004e-01,7.963814e-01,7.032965e-01,5.962002e-01,4.772262e-01,3.487447e-01,2.133154e-01,7.363634e-02,-6.750975e-02,-2.073109e-01,-3.429819e-01,-4.718199e-01,-5.912581e-01,-6.989170e-01,-7.926518e-01,-8.705950e-01,-9.311939e-01,-9.732412e-01,-9.958992e-01,-9.987165e-01,-9.816369e-01,-9.450008e-01,-8.895380e-01,-8.163534e-01,-7.269052e-01,-6.229752e-01,-5.066340e-01,-3.801995e-01,-2.461905e-01,-1.072768e-01,3.377414e-02,1.741522e-01,3.110607e-01,4.417722e-01,5.636825e-01,6.743629e-01,7.716083e-01,8.534815e-01,9.183512e-01,9.649252e-01,9.922755e-01,9.998574e-01,9.875196e-01,9.555081e-01,9.044606e-01,8.353940e-01,7.496844e-01,6.490393e-01,5.354637e-01,4.112205e-01,2.787847e-01,1.407948e-01,-6.428333e-13};
    
    for(int i = 0; i < 512; i++){std::cout << "a[" << i << "] = " << a[i] << std::endl;}

    float recons_signal[1024];
    float freq_coef[1024];
    PQMF_Process_Buffer x;
    x.setBufferSize(512);
    
    PQMF_Filter processor;
    IPQMF_Filter inv_processor;
    
    for(int rep = 0; rep < 1; rep++){
        
        for(int j = 0; j < 32; j++){
            
            for (int i = 0; i < 32; i++) {
                x.addSample(a[i + j*32]);
                //std::cout << "a![" << i +j*32 << "] = " << a[i +j*32] << std::endl;
            }
            x.internalPrint();
            
            float * output_analisis, * output_sintesis;
            
            output_analisis = processor.PQMF_Filtering(x.buffer);
            for(int i = 0; i < 32; i++){
                freq_coef[i+j*32] = output_analisis[i];
            }
            //for(int i = 0; i < 32; i++){std::cout << "y[" << i << "] = " << *(output_analisis + i) << std::endl;}
            
            output_sintesis = inv_processor.IPQMF_Filtering(output_analisis);
            
            for(int i = 0; i < 32; i++){std::cout << "x[" << i << "] = " << *(output_sintesis + i) << std::endl;}
            
            for(int i = 0; i < 32; i++){
                recons_signal[i+j*32] = *(output_sintesis + i);
            }
        }
    }
    for(int i = 0; i < 1024; i++){std::cout << recons_signal[i] << std::endl;}
    std::cout << "PQMF!: " << std::endl;
    for(int i = 0; i < 1024; i++){std::cout << freq_coef[i] << std::endl;}
}

/*
class B{

public:
    B(){
        b = 0;
    }
    
    void print(){
        std::cout << "B = " << b << std::endl;
    }
    
    void process(){
        b++;
        if (b == 16){
            b = 0;
        }
    }
    
private:
    int b;
};

int main(){
    B be;
    
    for (int i = 0; i < 32; i++){
        be.print();
        be.process();
    }
    be.print();
}
*/

